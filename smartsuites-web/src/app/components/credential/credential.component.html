<div [ngStyle]="{'min-height':min_height}">
  <p-dialog header="新建用户" [(visible)]="showAddNewUser" [modal]=true >
    <div>
      <div class="form-group">

        <div class="ui-inputgroup">
          <span class="ui-inputgroup-addon"><i class="fa fa-users"></i></span>
          <input type="text" pInputText placeholder="Username" size="60" #username>
        </div>

        <div class="ui-inputgroup" style="margin-top: 20px">
          <span class="ui-inputgroup-addon"><i class="fa fa-key"></i></span>
          <input pPassword type="password" placeholder="Password" size="60" #password>
        </div>

        <div class="ui-inputgroup" style="margin-top: 20px">
          <span class="ui-inputgroup-addon"><i class="fa fa-envelope-o"></i></span>
          <input type="text" pInputText placeholder="Email" size="60" #email>
        </div>

        <div style="margin-top: 20px">
          <p-selectButton [options]="types" [(ngModel)]="userType"></p-selectButton>
        </div>

        <!--<div *ngIf="userType == 'analyst'"  style="margin-top: 20px">
          <p-fieldset legend="资源目录">
            <div class="ui-g" style="width:250px;margin-bottom:10px">
              <div class="ui-g-12"><p-checkbox name="group1" value="New York" label="Spark" inputId="ny"></p-checkbox></div>
              <div class="ui-g-12"><p-checkbox name="group1" value="San Francisco" label="Hadoop" inputId="sf"></p-checkbox></div>
              <div class="ui-g-12"><p-checkbox name="group1" value="Los Angeles" label="Kylin" inputId="la"></p-checkbox></div>
            </div>
          </p-fieldset>
        </div>

        <div *ngIf="userType == 'business'"  style="margin-top: 20px">
          <p-fieldset legend="报表目录">
            <p-tree [value]="visionTree" selectionMode="checkbox" [(selection)]="selectedUserTreeNodes"></p-tree>
          </p-fieldset>
        </div>-->

      </div>
    </div>

    <p-footer>
      <button type="button" pButton icon="fa-plus-circle" (click)="createNewUser(username.value,password.value,email.value,userType);showAddNewUser=false" label="创建用户"></button>
    </p-footer>
  </p-dialog>

  <p-dialog header="修改用户" [(visible)]="showEditUser" [modal]=true >
    <div>
      <div class="form-group">

        <div class="ui-inputgroup">
          <span class="ui-inputgroup-addon"><i class="fa fa-users"></i></span>
          <input type="text" pInputText placeholder="Username" size="60">
        </div>

        <div class="ui-inputgroup" style="margin-top: 20px">
          <span class="ui-inputgroup-addon"><i class="fa fa-key"></i></span>
          <input pPassword type="password" placeholder="Password" size="60">
        </div>

        <div class="ui-inputgroup" style="margin-top: 20px">
          <span class="ui-inputgroup-addon"><i class="fa fa-envelope-o"></i></span>
          <input type="text" pInputText placeholder="Email" size="60">
        </div>

        <div style="margin-top: 20px">
          <p-selectButton [options]="types" [(ngModel)]="userType"></p-selectButton>
        </div>

        <!--<div *ngIf="userType == 'analyst'"  style="margin-top: 20px">
          <p-fieldset legend="资源目录">
            <div class="ui-g" style="width:250px;margin-bottom:10px">
              <div class="ui-g-12"><p-checkbox name="group1" value="New York" label="Spark" inputId="ny"></p-checkbox></div>
              <div class="ui-g-12"><p-checkbox name="group1" value="San Francisco" label="Hadoop" inputId="sf"></p-checkbox></div>
              <div class="ui-g-12"><p-checkbox name="group1" value="Los Angeles" label="Kylin" inputId="la"></p-checkbox></div>
            </div>
          </p-fieldset>
        </div>

        <div *ngIf="userType == 'business'"  style="margin-top: 20px">
          <p-fieldset legend="报表目录">
            <p-tree [value]="visionTree" selectionMode="checkbox" [(selection)]="selectedUserTreeNodes"></p-tree>
          </p-fieldset>
        </div>-->

      </div>
    </div>

    <p-footer>
      <button type="button" pButton icon="fa-plus-circle" (click)="display=false" label="创建笔记"></button>
    </p-footer>
  </p-dialog>

  <p-dialog header="新建目录" [(visible)]="showAddDirectory" [modal]=true >
    <div>
      <div class="form-group">

        <h3>父目录：{{selectedTreeNode?selectedTreeNode.label: 'No Node Selected'}}</h3>
        <div class="ui-inputgroup">
          <span class="ui-inputgroup-addon"><i class="fa fa-folder-o"></i></span>
          <input type="text" pInputText placeholder="directory" size="60" #dirname>
        </div>

      </div>
    </div>

    <p-footer>
      <button type="button" pButton icon="fa-plus-circle" (click)="createNewDir(selectedTreeNode,dirname.value);showAddDirectory=false" label="创建目录"></button>
    </p-footer>
  </p-dialog>

  <p-dialog header="配置目录" [(visible)]="showEditDir" [modal]=true >
    <div>
      <div class="form-group">

        <p-fieldset legend="配置目录">
          <p-tree [value]="visionTree" selectionMode="checkbox" [(selection)]="selectedUserTreeNodes"></p-tree>
        </p-fieldset>

      </div>
    </div>

    <p-footer>
      <button type="button" pButton icon="fa-plus-circle" (click)="saveUserDirs();showEditDir=false" label="配置目录"></button>
    </p-footer>
  </p-dialog>

  <p-dialog header="目录重命名" [(visible)]="showEditDirectory" [modal]=true >
    <div>
      <div class="form-group">

        <h3>当前名称：{{selectedTreeNode?selectedTreeNode.label: 'No Node Selected'}}</h3>
        <div class="ui-inputgroup">
          <span class="ui-inputgroup-addon"><i class="fa fa-folder-o"></i></span>
          <input type="text" pInputText placeholder="directory" size="60" #newname>
        </div>

      </div>
    </div>

    <p-footer>
      <button type="button" pButton icon="fa-plus-circle" (click)="updateDirName(selectedTreeNode,newname.value);showEditDirectory=false" label="更新目录"></button>
    </p-footer>
  </p-dialog>

  <div class="ui-g">

    <div class="ui-g-12">
      <p-toolbar>
        <div class="ui-toolbar-group-left">
          <button pButton type="button" label="添加目录" pTooltip="添加目录" tooltipPosition="bottom" icon="fa-plus-circle" class="ui-button-success"
                  (click)="showAddDirectory=true" [disabled]="!selectedTreeNode"></button>
          <button pButton type="button" label="修改目录" pTooltip="修改目录" tooltipPosition="bottom" icon="fa-edit" class="ui-button-info"
                  (click)="showEditDirectory=true" [disabled]="!selectedTreeNode"></button>
          <button pButton type="button" label="删除目录" pTooltip="删除目录" tooltipPosition="bottom" icon="fa-trash-o" class="ui-button-warning"
                  (click)="deleteDir(selectedTreeNode)" [disabled]="!selectedTreeNode"></button>
        </div>

        <div class="ui-toolbar-group-right">
          <button pButton type="button" label="新建用户" pTooltip="新建用户" tooltipPosition="bottom" icon="fa-plus-circle"
                  (click)="showAddNewUser=true"></button>
          <button pButton type="button" label="修改用户" pTooltip="修改用户" tooltipPosition="bottom" icon="fa-edit" class="ui-button-success"
                  (click)="showEditUser=true" [disabled]="!selectUser"></button>
          <button pButton type="button" label="目录配给" pTooltip="为业务用户配置可视化目录" tooltipPosition="bottom" icon="fa-folder" class="ui-button-info"
                  (click)="showEditDir=true" [disabled]="!selectUser"></button>
          <button pButton type="button" label="资源配给" pTooltip="为分析用户配置解析器资源" tooltipPosition="bottom" icon="fa-cube" class="ui-button-warning"
                  [disabled]="!selectUser"></button>
          <button pButton type="button" label="删除用户" pTooltip="删除用户" tooltipPosition="bottom" class="ui-button-danger" icon="fa-bitbucket"
                  (click)="removeUser(selectUser)" [disabled]="!selectUser"></button>
        </div>
      </p-toolbar>
    </div>

    <div class="ui-g-2 credential">
      <p-panel header="可视化目录管理">
        <p-tree [value]="visionTree" selectionMode="single" [loading]="loading" [(selection)]="selectedTreeNode"></p-tree>
      </p-panel>

    </div>
    <div class="ui-g-10">
      <p-panel header="用户配置管理">
        <p-treeTable [value]="users" [(selection)]="selectUser" selectionMode="single">
          <p-column header="用户配置详情">
            <ng-template let-node="rowData">

              <div *ngIf="node.data.type == 'Folder'" style="float: left;font-weight: bolder;">
                <i class="fa fa-cog" *ngIf="node.data.data == 'MANAGER'"></i>
                <i class="fa fa-tachometer" *ngIf="node.data.data == 'ANALYST'"></i>
                <i class="fa fa-line-chart" *ngIf="node.data.data == 'BUSINESS'"></i>&nbsp;&nbsp;&nbsp;{{node.data.username}}
              </div>

              <div *ngIf="node.data.type == 'Document'" class="user">
                <img src="assets/layout/images/avatar.png" width="45">
                <div class="contact-info">
                  <span class="name">{{node.data.username}}</span>
                  <span class="location">{{node.data.email}}</span>
                </div>
                <div class="contact-actions">
                  <span class="connection-status online">online</span>
                  <i class="fa fa-paper-plane-o"></i>
                  <i class="fa fa-phone"></i>
                </div>
              </div>

            </ng-template>
          </p-column>

          <!--<p-column field="username" header="用户名" [sortable]="true"></p-column>
          <p-column field="email" header="电子邮箱" [sortable]="true"></p-column>
          <p-column field="roles" header="用户角色" [sortable]="true"></p-column>
          <p-column field="views" header="可视化节点" [sortable]="true"></p-column>
          <p-column field="time" header="创建时间" [sortable]="true"></p-column>-->
        </p-treeTable>
      </p-panel>

    </div>

  </div>

</div>
